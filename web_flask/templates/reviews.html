<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Rese침as de {{ game[1] }}</title>
    <link rel="stylesheet" href="{{ url_for('static', filename='css/estilos.css') }}">
</head>
<body>
    <header>
        <div><img src="https://png.pngtree.com/png-vector/20191028/ourlarge/pngtree-game-control-line-icon-vector-png-image_1904129.jpg" alt="logo" height="100" width="100"></div>
        <div class="header">Enfocat Games Reviews</div>
    </header>

    <nav>
        <ul>
            <li><a href="/">Home</a></li>
            {% if 'user_id' in session %}
                <li><a href="/profile">Profile ({{ session['username'] }})</a></li>
            {% else %}
                <li><a href="/login">Register/Login</a></li>
            {% endif %}
            <li><a href="/games">Games</a></li>
        </ul>
    </nav>

    <main>
        <h1>Rese침as de {{ game['name'] }}</h1>  <!-- Nombre del juego -->
        <img src="{{ game['image'] }}" alt="Game Image" width="200">  <!-- Imagen -->
        <p><strong>Category:</strong> {{ game['category'] }}</p>  <!-- Categor칤a -->
        <p><strong>Likes:</strong> <span id="like-count">{{ game['like_count'] }}</span></p>
            {% if 'user_id' in session %}
                <button id="like-button" onclick="toggleLike({{ game['id'] }})">
                    游녨 Like
                </button>
            {% endif %}


        <h2>Rese침as:</h2>
        {% if reviews %}
            <ul id="test">
                {% for review in reviews %}
                <li><strong>{{ review['username'] }}</strong>: {{ review['content'] }}</li>
                {% endfor %}
            </ul>
        {% else %}
            <p>No hay rese침as para este juego a칰n.</p>
        {% endif %}

        <!-- Formulario para agregar una nueva rese침a -->
        {% if 'user_id' in session %}
            <form method="POST">
                <textarea name="content" placeholder="Escribe una rese침a..." required></textarea><br>
                <button type="submit">Enviar rese침a</button>
            </form>
        {% else %}
            <p>Necesitas iniciar sesi칩n para agregar una rese침a.</p>
        {% endif %}
    </main>
    <script>
        function toggleLike(gameId) {
            fetch(`/toggle_like/${gameId}`, { method: 'POST' })
            .then(response => response.json())
            .then(data => {
                if (data.error) {
                    alert(data.error);
                } else {
                    document.getElementById('like-count').innerText = data.like_count;
                    let btn = document.getElementById('like-button');
                    btn.innerText = data.liked ? "仇벒잺 Liked" : "游녨 Like";
                }
            })
            .catch(error => console.error('Error:', error));
        }
        </script>
        
    <footer></footer>
</body>
</html>


